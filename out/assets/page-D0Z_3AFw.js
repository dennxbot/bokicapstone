import{b as y,u as b,r as o,j as e}from"./index-rA_UgCij.js";import{u as N,s as v}from"./useAuth-CjWk1XML.js";import{u as _}from"./useOrders-F2k_At8J.js";import{f as u}from"./currency-XAUvB6j1.js";const P=()=>{var x;const{id:r}=y(),n=b(),{user:d}=N(),{getOrderById:i}=_(),[s,l]=o.useState(null),[p,m]=o.useState(!0);o.useEffect(()=>{if(!d){n("/login");return}(async()=>{if(r)try{m(!0);const t=await i(r);l(t)}catch(t){console.error("Error loading order:",t),l(null)}finally{m(!1)}})();const c=v.channel(`order-${r}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders",filter:`id=eq.${r}`},async()=>{if(r){const t=await i(r);l(t)}}).on("postgres_changes",{event:"*",schema:"public",table:"order_status_history",filter:`order_id=eq.${r}`},async()=>{if(r){const t=await i(r);l(t)}}).subscribe();return()=>{c.unsubscribe()}},[r,d,n,i]);const j=()=>{const a=[{key:"pending",label:"Order Placed",icon:"ri-check-line"},{key:"preparing",label:"Preparing",icon:"ri-restaurant-line"},{key:"ready",label:(s==null?void 0:s.order_type)==="delivery"?"Ready for Delivery":"Ready for Pickup",icon:(s==null?void 0:s.order_type)==="delivery"?"ri-truck-line":"ri-store-line"},{key:"out_for_delivery",label:(s==null?void 0:s.order_type)==="delivery"?"Out for Delivery":"Ready for Pickup",icon:(s==null?void 0:s.order_type)==="delivery"?"ri-truck-line":"ri-store-line"},{key:"completed",label:"Completed",icon:"ri-check-double-line"}],t=["pending","preparing","ready","out_for_delivery","completed"].indexOf((s==null?void 0:s.status)||"pending");return a.map((f,h)=>({...f,completed:h<=t,active:h===t}))};if(p)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-orange-500 border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});if(!d)return null;if(!s)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Order not found"}),e.jsx("button",{onClick:()=>n("/orders"),className:"text-orange-600 hover:text-orange-700",children:"Back to Orders"})]})});const g=j();return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsx("div",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-md mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>n("/orders"),className:"mr-4",children:e.jsx("i",{className:"ri-arrow-left-line text-xl"})}),e.jsx("h1",{className:"text-xl font-bold",children:"Order Details"})]})})}),e.jsxs("div",{className:"max-w-md mx-auto px-4 py-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["Order #",s.id.slice(-4)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(s.created_at).toLocaleDateString()," at ",new Date(s.created_at).toLocaleTimeString()]})]}),e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium text-orange-600 bg-orange-100 capitalize",children:s.status.replace("_"," ")})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Order Status"}),e.jsx("div",{className:"space-y-4",children:g.map(a=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center mr-4 ${a.completed?"bg-green-500 text-white":a.active?"bg-orange-500 text-white":"bg-gray-200 text-gray-400"}`,children:e.jsx("i",{className:`${a.icon} text-sm`})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:`font-medium ${a.completed||a.active?"text-gray-900":"text-gray-400"}`,children:a.label})}),a.completed&&e.jsx("i",{className:"ri-check-line text-green-500"})]},a.key))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Order Items"}),(x=s.order_items)==null?void 0:x.map((a,c)=>{var t;return e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((t=a.food_items)==null?void 0:t.name)||"Unknown Item"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsxs("span",{children:["Qty: ",a.quantity]}),a.size_name&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Size: ",a.size_name]})]})]})]}),e.jsx("p",{className:"font-semibold",children:u(a.total_price)})]},c)}),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-lg font-bold",children:"Total"}),e.jsx("p",{className:"text-lg font-bold text-orange-600",children:u(s.total_amount)})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Customer Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Name: "}),e.jsx("span",{className:"font-medium",children:s.customer_name})]}),s.customer_phone&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Contact: "}),e.jsx("span",{className:"font-medium",children:s.customer_phone})]}),s.customer_email&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Email: "}),e.jsx("span",{className:"font-medium",children:s.customer_email})]}),s.customer_address&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Address: "}),e.jsx("span",{className:"font-medium",children:s.customer_address})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Method: "}),e.jsx("span",{className:"font-medium capitalize",children:s.order_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Payment: "}),e.jsx("span",{className:"font-medium capitalize",children:s.payment_method==="cash"?s.order_type==="delivery"?"Cash on Delivery":"Pay on Pickup":s.payment_method})]})]})]}),s.status!=="completed"&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-information-line text-orange-600 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-orange-800",children:"Need Help?"}),e.jsx("p",{className:"text-orange-700 text-sm",children:"Contact us if you have any questions about your order."})]})]})})]})]})};export{P as default};
//# sourceMappingURL=page-D0Z_3AFw.js.map
