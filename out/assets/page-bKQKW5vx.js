import{b as F,u as D,r as o,j as e}from"./index-rA_UgCij.js";import{u as A}from"./useFoodItems-CGujWiXl.js";import{u as P}from"./useSizes-DUu48KPE.js";import{u as E}from"./useCart-4OqJo4WX.js";import{u as T}from"./useAuth-CjWk1XML.js";import{f as m}from"./currency-XAUvB6j1.js";import{B as N}from"./Button-CaIT6pSL.js";function G(){const{id:a}=F(),u=D(),{addToCart:v}=E(),{user:y}=T(),{getFoodItemById:w,isLoading:_}=A(),{getFoodItemSizes:p}=P(),[l,j]=o.useState(1),[n,x]=o.useState(""),[h,z]=o.useState(!1),[g,b]=o.useState([]),[S,f]=o.useState(!0),d=o.useRef(null),t=w(a||"");o.useEffect(()=>{(async()=>{if(!a){console.log("🚫 No food item ID provided");return}if(d.current===a){console.log("🔄 Sizes already loaded for this item");return}console.log("🔍 Loading sizes for food item:",a),console.log("📋 Item details:",t);try{f(!0),console.log("⏳ Calling getFoodItemSizes...");const i=await p(a);console.log("✅ Sizes loaded:",i),b(i),d.current=a,i.length>0&&!n?(console.log("🎯 Setting default selected size:",i[0].id),x(i[0].id)):i.length===0&&console.log("⚠️ No sizes found for this item")}catch(i){console.error("❌ Error loading sizes:",i),console.log("⚠️ No sizes configured for this item - size selection will be hidden"),b([]),x(""),d.current=a}finally{console.log("🏁 Setting sizesLoading to false"),f(!1)}})()},[a,p]),o.useEffect(()=>{a&&d.current!==a&&(b([]),x(""),f(!0),d.current=null)},[a]);const r=g.find(s=>s.id===n),c=r?r.calculated_price:(t==null?void 0:t.price)||0;console.log("=".repeat(50)),console.log("🔍 FOOD DETAILS DEBUG - Full Pricing Flow"),console.log("=".repeat(50)),console.log("📋 Item Info:",{itemId:t==null?void 0:t.id,itemName:t==null?void 0:t.name,basePrice:t==null?void 0:t.price,category:t==null?void 0:t.category}),console.log("📏 Size Selection:",{selectedSize:n,selectedSizeData:r?{id:r.id,name:r.name,calculated_price:r.calculated_price,price_multiplier:r.price_multiplier,base_price:r.base_price}:null}),console.log("💰 Price Calculation:",{currentPrice:c,priceSource:r?"size_calculated_price":"item_base_price"}),console.log("📊 All Available Sizes:",g.map(s=>({id:s.id,name:s.name,calculated_price:s.calculated_price,price_multiplier:s.price_multiplier,base_price:s.base_price}))),console.log("=".repeat(50));const C=()=>{var i;if(!y){u("/login");return}if(!t)return;const s={id:t.id,name:t.name,description:t.description||"",price:c,image:t.image_url||"",category:((i=t.category)==null?void 0:i.name)||"",featured:t.is_featured||!1,available:t.is_available||!0,size_option_id:n,size_name:(r==null?void 0:r.name)||void 0,size_multiplier:(r==null?void 0:r.price_multiplier)||void 0};console.log("🛒 ADDING TO CART - Debug Info:"),console.log("📦 Cart Item Object:",s),console.log("🔢 Quantity:",l),console.log("💵 Expected Price in Cart:",s.price),console.log("🏷️ Size Info:",{size_option_id:s.size_option_id,size_name:s.size_name,size_multiplier:s.size_multiplier}),v(s,l),setTimeout(()=>{console.log("⏰ POST-ADD DEBUG: Checking cart state after addition...")},100)},k=()=>j(s=>s+1),I=()=>j(s=>Math.max(1,s-1));return _?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-orange-200 border-t-orange-500 mx-auto mb-4"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("i",{className:"ri-restaurant-line text-orange-500 text-xl"})})]}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Loading delicious details..."})]})}):t?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-50",children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-md shadow-lg border-b border-orange-100 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-md mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsx("button",{onClick:()=>u(-1),className:"w-10 h-10 bg-orange-100 hover:bg-orange-200 rounded-full flex items-center justify-center cursor-pointer transition-colors duration-300",children:e.jsx("i",{className:"ri-arrow-left-line text-xl text-orange-600"})}),e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Food Details"}),e.jsx("button",{className:"w-10 h-10 bg-orange-100 hover:bg-orange-200 rounded-full flex items-center justify-center cursor-pointer transition-colors duration-300",children:e.jsx("i",{className:"ri-heart-line text-xl text-orange-600"})})]})}),e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden",children:[e.jsx("img",{src:t.image_url||`https://readdy.ai/api/search-image?query=delicious%20$%7Bitem.name%7D%20food%20photography%20with%20simple%20clean%20background&width=400&height=300&seq=${t.id}&orientation=landscape`,alt:t.name,className:"w-full h-full object-cover object-top"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 to-transparent"}),t.is_featured&&e.jsx("div",{className:"absolute top-6 left-6 bg-gradient-to-r from-yellow-400 to-orange-400 text-white px-4 py-2 rounded-full text-sm font-bold shadow-lg",children:"⭐ Featured Item"}),!t.is_available&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsx("div",{className:"bg-red-500 text-white px-6 py-3 rounded-2xl font-bold text-lg shadow-xl",children:"Out of Stock"})}),e.jsx("div",{className:"absolute bottom-6 right-6 bg-white/90 backdrop-blur-sm px-4 py-2 rounded-full",children:e.jsxs("div",{className:"flex items-center gap-1 text-yellow-500",children:[e.jsx("i",{className:"ri-star-fill"}),e.jsx("span",{className:"font-semibold text-gray-900",children:"4.8"}),e.jsx("span",{className:"text-gray-600 text-sm",children:"(124)"})]})})]}),e.jsx("div",{className:"bg-white rounded-t-3xl -mt-6 relative z-10 shadow-2xl",children:e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"flex items-start justify-between mb-6",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-3",children:t.name}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("span",{className:"text-3xl font-bold bg-gradient-to-r from-orange-500 to-red-500 bg-clip-text text-transparent",children:m(c)}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx("i",{className:"ri-time-line"}),e.jsx("span",{children:"15-20 min"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx("i",{className:"ri-fire-line"}),e.jsx("span",{children:"350 cal"})]})]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"Description"}),e.jsx("p",{className:`text-gray-600 leading-relaxed ${h?"":"line-clamp-3"}`,children:t.description||"A delicious and carefully prepared dish made with the finest ingredients. Perfect for any time of the day and guaranteed to satisfy your taste buds with its amazing flavors and textures."}),e.jsx("button",{onClick:()=>z(!h),className:"text-orange-500 font-medium text-sm mt-2 cursor-pointer hover:text-orange-600",children:h?"Show less":"Read more"})]}),t.is_available&&g.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Choose Size"}),S?e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3].map(s=>e.jsx("div",{className:"p-4 rounded-2xl border-2 border-gray-200 animate-pulse",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded"})]})},s))}):e.jsx("div",{className:"grid grid-cols-3 gap-3",children:g.map(s=>e.jsx("button",{onClick:()=>x(s.id),className:`p-4 rounded-2xl border-2 transition-all duration-300 cursor-pointer ${n===s.id?"border-orange-500 bg-orange-50 shadow-lg":"border-gray-200 hover:border-orange-300 hover:bg-orange-25"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:`font-semibold ${n===s.id?"text-orange-600":"text-gray-900"}`,children:s.name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.description}),e.jsx("p",{className:`text-sm font-medium mt-2 ${n===s.id?"text-orange-600":"text-gray-600"}`,children:m(s.calculated_price)})]})},s.id))})]}),t.is_available&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Quantity"}),e.jsxs("div",{className:"flex items-center justify-center gap-6 bg-gray-50 rounded-2xl p-4",children:[e.jsx("button",{onClick:I,className:"w-12 h-12 rounded-full bg-white border-2 border-orange-200 flex items-center justify-center hover:bg-orange-50 hover:border-orange-300 cursor-pointer transition-all duration-300 disabled:opacity-50",disabled:l<=1,children:e.jsx("i",{className:"ri-subtract-line text-orange-600"})}),e.jsx("span",{className:"text-2xl font-bold text-gray-900 w-12 text-center",children:l}),e.jsx("button",{onClick:k,className:"w-12 h-12 rounded-full bg-white border-2 border-orange-200 flex items-center justify-center hover:bg-orange-50 hover:border-orange-300 cursor-pointer transition-all duration-300",children:e.jsx("i",{className:"ri-add-line text-orange-600"})})]})]}),t.is_available&&e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 p-6 rounded-2xl mb-8 border border-orange-100",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Total Price"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[l," × ",m(c)]})]}),e.jsx("span",{className:"text-3xl font-bold bg-gradient-to-r from-orange-500 to-red-500 bg-clip-text text-transparent",children:m(c*l)})]})}),e.jsx(N,{onClick:C,disabled:!t.is_available,className:`w-full py-4 text-lg font-bold rounded-2xl transition-all duration-300 ${t.is_available?"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white shadow-xl hover:shadow-2xl transform hover:scale-105":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,size:"lg",children:t.is_available?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-shopping-cart-line mr-3"}),"Add to Cart - ",m(c*l)]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-close-circle-line mr-3"}),"Currently Out of Stock"]})})]})})]})]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center bg-white rounded-3xl p-8 shadow-xl border border-orange-100 max-w-sm mx-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-orange-100 to-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-error-warning-line text-3xl text-orange-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Food item not found"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"The item you're looking for doesn't exist"}),e.jsxs(N,{onClick:()=>u("/"),className:"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600",children:[e.jsx("i",{className:"ri-home-line mr-2"}),"Back to Home"]})]})})}export{G as default};
//# sourceMappingURL=page-bKQKW5vx.js.map
