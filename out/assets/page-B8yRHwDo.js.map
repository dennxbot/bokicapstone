{"version":3,"file":"page-B8yRHwDo.js","sources":["../../src/pages/orders/page.tsx"],"sourcesContent":["\r\nimport { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../../hooks/useAuth';\r\nimport { useOrders } from '../../hooks/useOrders';\r\nimport { formatPesoSimple } from '../../lib/currency';\r\nimport Button from '../../components/base/Button';\r\n\r\nconst Orders = () => {\r\n  const navigate = useNavigate();\r\n  const { user, isLoading } = useAuth();\r\n  const { fetchUserOrders } = useOrders();\r\n  const [orders, setOrders] = useState<any[]>([]);\r\n  const [ordersLoading, setOrdersLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // Don't redirect if still loading auth state\r\n    if (isLoading) return;\r\n    \r\n    if (!user) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    // Fetch real orders from database\r\n    const loadUserOrders = async () => {\r\n      try {\r\n        setOrdersLoading(true);\r\n        const userOrders = await fetchUserOrders(user.id);\r\n        setOrders(userOrders);\r\n      } catch (error) {\r\n        console.error('Error loading user orders:', error);\r\n        setOrders([]);\r\n      } finally {\r\n        setOrdersLoading(false);\r\n      }\r\n    };\r\n\r\n    loadUserOrders();\r\n  }, [user, navigate, isLoading, fetchUserOrders]);\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'pending':\r\n        return 'text-yellow-600 bg-yellow-100';\r\n      case 'preparing':\r\n        return 'text-blue-600 bg-blue-100';\r\n      case 'ready':\r\n        return 'text-purple-600 bg-purple-100';\r\n      case 'out_for_delivery':\r\n        return 'text-purple-600 bg-purple-100';\r\n      case 'completed':\r\n        return 'text-green-600 bg-green-100';\r\n      case 'cancelled':\r\n        return 'text-red-600 bg-red-100';\r\n      default:\r\n        return 'text-gray-600 bg-gray-100';\r\n    }\r\n  };\r\n\r\n  const formatStatus = (status: string) => {\r\n    return status.split('_').map(word => \r\n      word.charAt(0).toUpperCase() + word.slice(1)\r\n    ).join(' ');\r\n  };\r\n\r\n  // Show loading spinner while checking auth\r\n  if (isLoading || ordersLoading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-4 border-orange-500 border-t-transparent mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!user) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 pb-20\">\r\n      <div className=\"bg-white shadow-sm\">\r\n        <div className=\"max-w-md mx-auto px-4 py-4\">\r\n          <div className=\"flex items-center\">\r\n            <button onClick={() => navigate('/')} className=\"mr-4 cursor-pointer\">\r\n              <i className=\"ri-arrow-left-line text-xl\"></i>\r\n            </button>\r\n            <h1 className=\"text-xl font-bold\">My Orders</h1>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"max-w-md mx-auto px-4 py-6\">\r\n        {orders.length === 0 ? (\r\n          <div className=\"text-center py-12\">\r\n            <div className=\"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n              <i className=\"ri-shopping-bag-line text-3xl text-gray-400\"></i>\r\n            </div>\r\n            <h2 className=\"text-xl font-bold text-gray-800 mb-2\">No Orders Yet</h2>\r\n            <p className=\"text-gray-600 mb-6\">You haven't placed any orders yet. Start browsing our delicious menu!</p>\r\n            <Button onClick={() => navigate('/')} className=\"cursor-pointer\">Browse Menu</Button>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {orders.map((order) => (\r\n              <div key={order.id} className=\"bg-white rounded-lg shadow-sm p-4\">\r\n                <div className=\"flex justify-between items-start mb-3\">\r\n                  <div>\r\n                    <h3 className=\"font-semibold text-lg\">Order #{order.id.slice(-4)}</h3>\r\n                    <p className=\"text-sm text-gray-600\">\r\n                      {new Date(order.created_at).toLocaleDateString()} at {new Date(order.created_at).toLocaleTimeString()}\r\n                    </p>\r\n                  </div>\r\n                  <span className={`px-3 py-1 rounded-full text-xs font-medium ${getStatusColor(order.status)}`}>\r\n                    {formatStatus(order.status)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"space-y-2 mb-3\">\r\n                  {order.order_items?.map((item: any, index: number) => (\r\n                    <div key={index} className=\"flex justify-between text-sm\">\r\n                      <div>\r\n                        <span>{item.quantity}x {item.food_items?.name || 'Unknown Item'}</span>\r\n                        {item.size_name && (\r\n                          <span className=\"text-gray-500 ml-2\">({item.size_name})</span>\r\n                        )}\r\n                      </div>\r\n                      <span>{formatPesoSimple(item.total_price)}</span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center pt-3 border-t\">\r\n                  <div>\r\n                    <p className=\"font-semibold text-lg\">{formatPesoSimple(order.total_amount)}</p>\r\n                    <p className=\"text-sm text-gray-600 capitalize\">{order.order_type}</p>\r\n                  </div>\r\n                  <Button\r\n                    onClick={() => navigate(`/order/${order.id}`)}\r\n                    variant=\"outline\"\r\n                    className=\"text-sm px-4 py-2 whitespace-nowrap cursor-pointer\"\r\n                  >\r\n                    View Details\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Orders;\r\n"],"names":["Orders","navigate","useNavigate","user","isLoading","useAuth","fetchUserOrders","useOrders","orders","setOrders","useState","ordersLoading","setOrdersLoading","useEffect","userOrders","error","getStatusColor","status","formatStatus","word","jsxs","jsx","Button","order","_a","item","index","formatPesoSimple"],"mappings":"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"}