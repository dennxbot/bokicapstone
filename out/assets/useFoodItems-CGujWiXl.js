import{r as c}from"./index-rA_UgCij.js";import{s as n}from"./useAuth-CjWk1XML.js";const w=()=>{const[r,u]=c.useState([]),[g,m]=c.useState([]),[f,l]=c.useState(!0);c.useEffect(()=>{i();const e=n.channel("food_items_changes").on("postgres_changes",{event:"*",schema:"public",table:"food_items"},o=>{console.log("Real-time update received:",o),i()}).subscribe();return()=>{e.unsubscribe()}},[]);const i=async()=>{try{l(!0),console.log("ðŸ”„ Starting fetchData in useFoodItems...");const{data:e,error:o}=await n.from("categories").select("*").eq("is_active",!0).order("name");if(o)throw console.error("âŒ Categories error:",o),o;console.log("âœ… Categories fetched:",e==null?void 0:e.length),m(e||[]),console.log("ðŸ” About to query food_items table..."),console.log("ðŸ” Current auth state:",n.auth.getUser());const{data:t,error:s}=await n.from("food_items").select(`
          *,
          category:categories(name)
        `).order("name");if(console.log("ðŸ“‹ Raw query result:",{data:t,error:s}),s)throw console.error("âŒ Food items error:",s),s;console.log("âœ… Fetched food items:",t==null?void 0:t.length,"items"),console.log("ðŸ“Š Items with availability status:",t==null?void 0:t.map(a=>({name:a.name,is_available:a.is_available,is_featured:a.is_featured}))),u(t||[])}catch(e){console.error("ðŸ’¥ Error fetching data:",e)}finally{l(!1),console.log("ðŸ fetchData completed")}};return{foodItems:r,categories:g,isLoading:f,getFoodItemsByCategory:e=>r.filter(o=>o.category_id===e),getFeaturedItems:()=>r.filter(e=>e.is_featured),searchFoodItems:e=>{if(!e.trim())return r;const o=e.toLowerCase().trim();return r.filter(t=>{var d;const s=t.name.toLowerCase().includes(o),a=t.description&&t.description.toLowerCase().includes(o),h=((d=t.category)==null?void 0:d.name)&&t.category.name.toLowerCase().includes(o);return s||a||h})},getFoodItemById:e=>r.find(o=>o.id===e),refetch:i}};export{w as u};
//# sourceMappingURL=useFoodItems-CGujWiXl.js.map
