import{b as T,u as E,r as x,j as e}from"./index-rA_UgCij.js";import{f as b}from"./currency-XAUvB6j1.js";import{B as d}from"./Button-CaIT6pSL.js";import{u as z}from"./useOrders-F2k_At8J.js";import{u as A,s as M}from"./useAuth-CjWk1XML.js";const H=()=>{const{id:n}=T(),o=E(),{user:v}=A(),[t,h]=x.useState(null),[w,m]=x.useState(!0),[f,l]=x.useState(null),{orders:O,fetchOrders:I,getOrderById:j}=z();x.useEffect(()=>{n&&(async()=>{try{m(!0),l(null);const i=localStorage.getItem("lastOrder");if(i){const r=JSON.parse(i);if(r.id===n){h(r),m(!1);return}}if(n)try{let r=null;if(v)r=await j(n);else{const{data:{session:c}}=await M.auth.getSession();c!=null&&c.user?r=await j(n):l("Unable to load order. Please try logging in or check if the order ID is correct.")}r?h(r):l("Order not found. This could be due to a processing error or the order may not have been created successfully.")}catch(r){console.error("Error calling getOrderById:",r),l(`Database error: ${r instanceof Error?r.message:"Unknown error"}`)}else l("No order ID provided.");m(!1)}catch(i){console.error("Error loading order:",i),l("Failed to load order information. Please try again or contact support."),m(!1)}})()},[n,I,O]);const a=s=>"items"in s&&"customerInfo"in s,S=s=>a(s)?s.total:s.total_amount,C=s=>a(s)?s.items:s.order_items,k=s=>a(s)?s.customerInfo.fullName:s.customer_name,_=s=>a(s)?s.customerInfo.contactNumber:s.customer_phone,u=s=>a(s)?s.customerInfo.orderType:s.order_type,g=s=>a(s)?s.customerInfo.paymentMethod:s.payment_method,D=s=>a(s)?s.customerInfo.deliveryMethod==="delivery"?"45-60 minutes":"20-30 minutes":s.order_type==="delivery"?"45-60 minutes":"20-30 minutes";if(w)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Loading your order..."}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Checking localStorage and database..."})]})});if(f||!t)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[e.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Order Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:f||"We couldn't find your order. This might be due to a processing error."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(d,{onClick:()=>window.location.reload(),className:"w-full",children:"Try Again"}),e.jsx(d,{onClick:()=>o("/"),variant:"outline",className:"w-full",children:"Go Home"})]})]})});if(!t)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Order not found"}),e.jsx(d,{onClick:()=>o("/"),children:"Go Home"})]})});const P=D(t);return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsx("div",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-md mx-auto px-4 py-4",children:e.jsx("h1",{className:"text-xl font-bold text-center",children:"Order Confirmed!"})})}),e.jsxs("div",{className:"max-w-md mx-auto px-4 py-6",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-check-line text-2xl text-green-600"})}),e.jsx("h2",{className:"text-xl font-bold text-green-800 mb-2",children:"Order Placed Successfully!"}),e.jsx("p",{className:"text-green-700",children:"Thank you for your order. We'll prepare it with care."})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Order Details"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Order ID:"}),e.jsxs("span",{className:"font-medium",children:["#",t.id]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium",children:new Date(a(t)?t.createdAt:t.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:"font-medium text-orange-600 capitalize",children:t.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Delivery Method:"}),e.jsx("span",{className:"font-medium capitalize",children:u(t)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Payment:"}),e.jsx("span",{className:"font-medium capitalize",children:g(t)==="cash"?u(t)==="delivery"?"Cash on Delivery":"Pay on Pickup":g(t)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Order Items"}),C(t).map((s,i)=>{var y;const r=a(t)?s.name:((y=s.food_items)==null?void 0:y.name)||"Unknown Item",c=a(t)?s.price:s.unit_price,p=s.quantity,N=s.size_name;return e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsxs("span",{children:["Qty: ",p]}),N&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Size: ",N]})]})]})]}),e.jsx("p",{className:"font-semibold",children:b(c*p)})]},s.id||i)}),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-lg font-bold",children:"Total"}),e.jsx("p",{className:"text-lg font-bold text-orange-600",children:b(S(t))})]})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-time-line text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-blue-800",children:["Estimated ",u(t)==="delivery"?"Delivery":"Pickup"," Time"]}),e.jsx("p",{className:"text-blue-700",children:P})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Customer Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Name: "}),e.jsx("span",{className:"font-medium",children:k(t)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Contact: "}),e.jsx("span",{className:"font-medium",children:_(t)})]}),a(t)&&t.customerInfo.address&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Address: "}),e.jsx("span",{className:"font-medium",children:t.customerInfo.address})]}),!a(t)&&t.customer_address&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Address: "}),e.jsx("span",{className:"font-medium",children:t.customer_address})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(d,{onClick:()=>o("/orders"),className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold whitespace-nowrap",children:"View My Orders"}),e.jsx(d,{onClick:()=>o("/"),variant:"outline",className:"w-full border-gray-300 text-gray-700 py-3 rounded-lg font-semibold whitespace-nowrap",children:"Continue Shopping"})]})]})]})};export{H as default};
//# sourceMappingURL=page-CQHe2mX-.js.map
