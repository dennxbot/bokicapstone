import{u as b,r as n,j as e}from"./index-rA_UgCij.js";import{u as v}from"./useCart-4OqJo4WX.js";import{u as w}from"./useAuth-CjWk1XML.js";import{u as _}from"./useAddresses-Dc5xVLle.js";import{f as o}from"./currency-XAUvB6j1.js";import{B as j}from"./Button-CaIT6pSL.js";import{I as N}from"./Input-CP5KOtNX.js";const D=()=>{const d=b(),{items:m,getTotalPrice:h,createOrder:y}=v(),{user:t}=w(),{addresses:i,loadAddresses:x,getDefaultAddress:u}=_(),[a,c]=n.useState({fullName:"",contactNumber:"",selectedAddressId:"",deliveryMethod:"delivery",paymentMethod:"cash"}),[p,f]=n.useState(!1);n.useEffect(()=>{x()},[x]),n.useEffect(()=>{const s=u();s&&c(l=>({...l,selectedAddressId:s.id}))},[i,u]),n.useEffect(()=>{t&&c(s=>({...s,fullName:t.full_name||"",contactNumber:t.contact_number||""}))},[t]);const r=s=>{c({...a,[s.target.name]:s.target.value})},g=async()=>{if(!a.fullName||!a.contactNumber||!a.selectedAddressId){alert("Please fill in all required fields and select an address");return}if(!t){alert("Please login to place an order"),d("/login");return}const s=i.find(l=>l.id===a.selectedAddressId);if(!s){alert("Please select a valid address");return}f(!0);try{const l=await y({customerName:a.fullName,customerEmail:t.email||"",customerPhone:a.contactNumber,customerAddress:`${s.address_line_1}${s.address_line_2?", "+s.address_line_2:""}, ${s.city}, ${s.state} ${s.postal_code}, ${s.country}`,orderType:a.deliveryMethod,paymentMethod:a.paymentMethod,userId:t.id});d(`/order-confirmation/${l.id}`)}catch(l){console.error("Error placing order:",l),alert("Failed to place order. Please try again.")}finally{f(!1)}};return m.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Your cart is empty"}),e.jsx(j,{onClick:()=>d("/"),children:"Continue Shopping"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsx("div",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-md mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>d("/cart"),className:"mr-4",children:e.jsx("i",{className:"ri-arrow-left-line text-xl"})}),e.jsx("h1",{className:"text-xl font-bold",children:"Checkout"})]})})}),e.jsxs("div",{className:"max-w-md mx-auto px-4 py-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Order Summary"}),m.map(s=>e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Qty: ",s.quantity]})]}),e.jsx("p",{className:"font-semibold",children:o(s.price*s.quantity)})]},`${s.id}-${s.size_option_id||"default"}`)),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-lg font-bold",children:"Total"}),e.jsx("p",{className:"text-lg font-bold text-orange-600",children:o(h())})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Customer Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{label:"Full Name",name:"fullName",value:a.fullName,onChange:r,required:!0}),e.jsx(N,{label:"Contact Number",name:"contactNumber",type:"tel",value:a.contactNumber,onChange:r,required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Address *"}),i.length>0?e.jsx("div",{className:"space-y-2",children:i.map(s=>e.jsxs("label",{className:"flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"selectedAddressId",value:s.id,checked:a.selectedAddressId===s.id,onChange:r,className:"mt-1 mr-3"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.label}),s.is_default&&e.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded",children:"Default"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.address_line_1,s.address_line_2&&`, ${s.address_line_2}`,e.jsx("br",{}),s.city,", ",s.state," ",s.postal_code,e.jsx("br",{}),s.country]})]})]},s.id))}):e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx("p",{children:"No addresses found."}),e.jsx("button",{type:"button",onClick:()=>d("/profile"),className:"text-orange-600 hover:text-orange-700 font-medium mt-2",children:"Add an address in your profile"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Delivery Method"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"deliveryMethod",value:"delivery",checked:a.deliveryMethod==="delivery",onChange:r,className:"mr-3"}),e.jsx("span",{children:"Delivery"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"deliveryMethod",value:"pickup",checked:a.deliveryMethod==="pickup",onChange:r,className:"mr-3"}),e.jsx("span",{children:"Pickup"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Payment Method"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"cash",checked:a.paymentMethod==="cash",onChange:r,className:"mr-3"}),e.jsx("span",{children:a.deliveryMethod==="delivery"?"Cash on Delivery":"Pay on Pickup"})]})})]}),e.jsx(j,{onClick:g,disabled:p,className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold whitespace-nowrap",children:p?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Placing Order..."]}):e.jsxs(e.Fragment,{children:["Place Order - ",o(h())]})})]})]})};export{D as default};
//# sourceMappingURL=page-Ck5WRK4J.js.map
